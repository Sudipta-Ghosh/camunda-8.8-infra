global:
  elasticsearch:
    enabled: true
  secrets:
    autoGenerated: true
    name: "camunda-credentials"
  identity:
    auth:
      enabled: true
      publicIssuerUrl: "http://localhost:18080/auth/realms/camunda-platform"
      webModeler:
        redirectUrl: "http://localhost:8070"
      console:
        redirectUrl: "http://localhost:8087"
      optimize:
        redirectUrl: "http://localhost:8083"
        secret:
          existingSecret: "camunda-credentials"
          existingSecretKey: "identity-optimize-client-token"

      orchestration:
        redirectUrl: "http://localhost:8080"
        secret:
          existingSecret: "camunda-credentials"
          existingSecretKey: "identity-orchestration-client-token"
      connectors:
        secret:
          existingSecret: "camunda-credentials"
          existingSecretKey: "identity-connectors-client-token"
  security:
    authentication:
      method: oidc

identity:
  enabled: true
  firstUser:
    secret:
      existingSecret: "camunda-credentials"
      existingSecretKey: "identity-firstuser-password"

identityKeycloak:
  enabled: true
  postgresql:
    auth:
      existingSecret: "camunda-credentials"

connectors:
  enabled: true
  security:
    authentication:
      method: oidc
      oidc:
        secret:
          existingSecret: "camunda-credentials"
          existingSecretKey: "identity-connectors-client-token"

webModeler:
  enabled: true
  restapi:
    mail:
      # This value is required, otherwise the restapi pod wouldn't start.
      fromAddress: noreply@example.com

# WebModeler Database.
webModelerPostgresql:
  resources:
    requests:
      cpu: "50m"
      memory: "128Mi"
    limits:
      cpu: "150m"
      memory: "256Mi"
  enabled: true
  auth:
    existingSecret: "camunda-credentials"
    secretKeys:
      adminPasswordKey: "webmodeler-postgresql-admin-password"
      userPasswordKey: "webmodeler-postgresql-user-password"

orchestration:
  resources:
    requests:
      cpu: "500m"
      memory: "256Mi"
    limits:
      cpu: "1"
      memory: "1Gi"
  enabled: true
  clusterSize: "1"
  partitionCount: "1"
  replicationFactor: "1"
  # Zeebe records retention
  retention:
    enabled: true
    minimumAge: 3m
    policyName: zeebe-record-retention-policy
  # Historical data archiving and retention
  history:
    waitPeriodBeforeArchiving: 5m
    rolloverInterval: 1h
    rolloverBatchSize: 100
    elsRolloverDateFormat: date
    delayBetweenRuns: 2000
    maxDelayBetweenRuns: 60000
    retention:
      enabled: true
      minimumAge: 5m
      policyName: camunda-history-retention-policy
      usageMetricsMinimumAge: 730d
      usageMetricsPolicyName: camunda-usage-metrics-retention-policy
  # Configure MongoDB exporter
  exporters:
    zeebe:
      enabled: true
  # Enable INFO logging for the MongoDB exporter package
  # (Camunda only enables INFO for io.camunda.* by default; custom packages default to WARN)
  env:
    - name: LOGGING_LEVEL_IO_GITHUB_CAMUNDA8
      value: "DEBUG"
    - name: ZEEBE_BROKER_EXPORTERS_CAMUNDAEXPORTER_ARGS_HISTORY_RETENTION_ENABLED
      value: "true"
    - name: CAMUNDA_OPERATE_ARCHIVER_ENABLED       # ensure archiver is on
      value: "true"
    - name: CAMUNDA_OPERATE_ARCHIVER_ILMENABLED     # create ILM retention policy
      value: "true"
    - name: CAMUNDA_OPERATE_ARCHIVER_RETENTION_ENABLED
      value: "true"
  security:
    authentication:
      method: oidc
      oidc:
        redirectUrl: "http://localhost:8080"
        secret:
          existingSecret: "camunda-credentials"
          existingSecretKey: "identity-orchestration-client-token"

console:
  enabled: true
  image:
    repository: camunda/console
    tag: "8.8.11"
    pullPolicy: IfNotPresent

elasticsearch:
  resources:
    requests:
      cpu: "250m"
      memory: "512Mi"
    limits:
      cpu: "500m"
      memory: "2Gi"
  enabled: true
  master:
    replicaCount: 1
    resources:
      requests:
        cpu: "250m"
        memory: "512Mi"
      limits:
        cpu: "500m"
        memory: "2Gi"
    # Ensure the JVM heap is smaller than the container memory to avoid OOMKills
    extraEnvs:
      - name: ELASTICSEARCH_HEAP_SIZE
        value: "1024m"
    persistence:
      size: 10Gi
      extraConfig:
    logger.org.elasticsearch.deprecation: "OFF"
    indices.lifecycle.poll_interval: "10s"
